<!DOCTYPE html>
<html>
<head>
    <title>UPI Payment</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
<h2>Pay â‚¹100</h2>

<!-- QR Code for users to scan if needed -->
<img src="{{ url_for('static', filename='payment_qr.png') }}" alt="Scan QR to pay" width="200">

<button id="payBtn">Pay Now</button>

<script>
var options = {
    "key": "{{ key }}",
    "amount": "{{ amount }}",
    "currency": "INR",
    "name": "Token System",
    "description": "Payment for Token",
    "order_id": "{{ order_id }}",

    // Force UPI only (PhonePe, GPay, Paytm)
    "method": {
        "upi": true,
        "card": false,
        "netbanking": false,
        "wallet": false
    },

    "handler": function (response){
        var form = document.createElement("form");
        form.method = "POST";
        form.action = "/payment-success";

        var payment_id = document.createElement("input");
        payment_id.type = "hidden";
        payment_id.name = "razorpay_payment_id";
        payment_id.value = response.razorpay_payment_id;

        var order_id = document.createElement("input");
        order_id.type = "hidden";
        order_id.name = "razorpay_order_id";
        order_id.value = response.razorpay_order_id;

        var signature = document.createElement("input");
        signature.type = "hidden";
        signature.name = "razorpay_signature";
        signature.value = response.razorpay_signature;

        form.appendChild(payment_id);
        form.appendChild(order_id);
        form.appendChild(signature);
        document.body.appendChild(form);
        form.submit();
    }
};

document.getElementById("payBtn").onclick = function(){
    var rzp = new Razorpay(options);
    rzp.open();
};
</script>

</body>
</html>